name: build sphinx document
on: 
  push:
    branches:
      - 'docs'
    paths:
      - 'source/**'
      - '.github/workflows/sphinx-build.yml'
      # sourceã®é…ä¸‹ã‹ã€buildã®actionã‚’æ›¸ãæ›ãˆãŸã‚‰ãƒˆãƒªã‚¬ãƒ¼ã¨ã™ã‚‹ã€‚
jobs:
  main:
    name: build sphinx document
    runs-on: ubuntu-latest
    steps:
      # è‡ªåˆ†ã® repository ã‚’ checkout ã™ã‚‹ã€‚
      # é«˜é€ŸåŒ–ã¯ã€ãƒ‡ã‚£ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ã‚ã¨ã§ç¢ºèªã™ã‚‹ã€‚
      # --depth 1 ã ã£ãŸã¯ãš?
      - name: Checkout Repository
        uses: actions/checkout@v2
        with:
          ref: docs
      # Identity ã‚’è¨­å®š
      - name: set identity
        run: |
          git config --global user.email "bot@example.com"
          git config --global user.name "bot"
      - name: Set up Ubuntu 20.04 environment
        run: |
          sudo apt update
          sudo apt -y upgrade
          sudo apt install python3-sphinx python3-sphinx-rtd-theme python3-sphinxcontrib.plantuml python3-pip
          pip3 -V
      - name: build sphinx document
        run: |
          make html
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./build/html/
            # doctree ã¯ä¸­é–“çµæœã‚’æ›¸ãå‡ºã—ã¦ã„ã‚‹ãŸã‘ãªã®ã§ã€
            # é™çš„ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã™ã‚‹ã¨ãã«ã¯ä¸è¦ã¨ã—ã¦
            # ./build/html/ã®å†…å®¹ã‚’æœ€ä¸Šä½ã¨ã™ã‚‹ã€‚
            #  publish_branch: gh-pages
            #  publish_dir: .
            #  see peaceiris/actions-gh-pages: GitHub Actions for GitHub Pages ğŸš€ Deploy static files and publish your site easily. Static-Site-Generators-friendly. https://github.com/peaceiris/actions-gh-pages

